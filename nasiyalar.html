function renderNasiyaList() {
  const list = document.getElementById("nasiyaList");
  list.innerHTML = "";
  let total = 0;

  nasiyalar.forEach((item) => {
    total += item.qoldiq;

    const el = document.createElement("div");
    el.className = "nasiya";

    const header = document.createElement("div");
    header.className = "nasiya-header";
    header.textContent = `${item.ism} - ${formatSum(item.qoldiq)}`;

    const tarix = document.createElement("div");
    tarix.className = "tarix";

    // Filtrlash: 0 so'mli "pul berdi" yozuvlarini ko‘rsatmaymiz
    const filteredTarix = item.tarix.filter(x => {
      return !(x.includes("pul berdi") && x.includes("0 so'm"));
    });

    // Tarixni to‘g‘ri formatda HTML qilib chiqaramiz
    filteredTarix.forEach(t => {
      const p = document.createElement("div");
      p.textContent = t;
      tarix.appendChild(p);
    });

    // Endi event listener: bitta marta bosish bilan ochiladi
    header.addEventListener("click", () => {
      tarix.style.display = tarix.style.display === "block" ? "none" : "block";
    });

    el.appendChild(header);
    el.appendChild(tarix);
    list.appendChild(el);
  });

  document.getElementById("totalSum").textContent = `Nasiyalar: ${formatSum(total)}`;
}
